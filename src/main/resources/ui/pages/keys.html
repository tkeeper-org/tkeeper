<div class="row row-cards">
    <div class="col-12">
        <div class="card shadow-sm border-0 tk-panel">
            <div class="tk-panel-head">
                <div class="tk-panel-ident">
                    <span class="bg-blue-lt avatar rounded">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3" /><path d="M12 10l-2 2l2 2l2 -2l-2 -2" /><path d="M12 13l0 9" /></svg>
                    </span>
                    <div class="tk-panel-title-wrap">
                        <div class="tk-panel-kicker">Cryptography</div>
                        <h3 class="card-title mb-0 fw-bold tk-panel-title">Vault</h3>
                    </div>
                </div>
                <div class="tk-panel-actions">
                    <span class="badge bg-indigo-lt d-none" id="tk-keys-mode-badge">Historical Mode</span>
                    <button id="tk-keys-reload" class="btn btn-action btn-sm" type="button" title="Reload">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" /><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" /></svg>
                    </button>
                </div>
            </div>

            <div class="card-body p-4">
                <div id="tk-keys-historical-banner" class="alert alert-info align-items-center justify-content-between py-2 mb-4 d-none">
                    <div class="d-flex align-items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 8l0 4l2 2" /><path d="M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5" /></svg>
                        <div>
                            <span class="fw-semibold">Historical View:</span>
                            <span class="font-monospace ms-1" id="tk-keys-historical-key"></span>
                            <span class="text-muted small ms-2" id="tk-keys-historical-meta"></span>
                        </div>
                    </div>
                    <button id="tk-keys-exit-historical" class="btn btn-sm btn-white text-info border-info" type="button">Exit historical</button>
                </div>

                <div class="row g-2 mb-4 align-items-center">
                    <div class="col-md-8">
                        <div class="input-group input-group-flat bg-white border">
                            <input id="tk-keys-logicalId" class="form-control border-0" placeholder="Search by logical ID...">
                        </div>
                    </div>
                    <div class="col-6 col-md-2">
                        <select id="tk-keys-limit" class="form-select bg-light border-0">
                            <option value="50">50 rows</option>
                            <option value="100">100 rows</option>
                            <option value="200" selected>200 rows</option>
                        </select>
                    </div>
                    <div class="col-6 col-md-2 d-grid">
                        <button class="btn btn-ghost-secondary" id="tk-keys-clear" type="button">Clear</button>
                    </div>
                </div>

                <div class="table-responsive rounded border mb-3">
                    <table class="table table-vcenter table-nowrap table-hover mb-0">
                        <thead class="bg-light text-uppercase small fw-bold text-muted ls-1">
                        <tr>
                            <th class="ps-3">Logical ID</th>
                            <th>Curve</th>
                            <th>Gen</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody id="tk-keys-tbody" class="font-size-sm">
                        <tr><td colspan="5" class="p-4 text-center text-muted">Loadingâ€¦</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="d-flex justify-content-between align-items-center">
                    <div class="text-muted small" id="tk-keys-footer"></div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-secondary btn-sm" id="tk-keys-prev" disabled type="button">Previous</button>
                        <button class="btn btn-outline-secondary btn-sm" id="tk-keys-next" disabled type="button">Next</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tk-modal" id="tk-modal-sigs" tabindex="-1" aria-hidden="true">
        <div class="tk-modal-backdrop" id="tk-modal-sigs-backdrop"></div>
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content shadow-lg">
                <div class="modal-header border-bottom">
                    <h5 class="modal-title fw-bold">Signatures</h5>
                    <button type="button" class="btn-close" id="tk-sigs-close" aria-label="Close"></button>
                </div>

                <div class="modal-body p-4 bg-body">
                    <div class="row g-2 mb-4">
                        <div class="col-md-4">
                            <label class="form-label small text-muted text-uppercase fw-bold ls-1">Key</label>
                            <input id="tk-sigs-key" class="form-control bg-light border-0 fw-mono" readonly>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small text-muted text-uppercase fw-bold ls-1">Curve</label>
                            <input id="tk-sigs-curve" class="form-control bg-light border-0 fw-mono" readonly>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small text-muted text-uppercase fw-bold ls-1">Mode</label>
                            <select id="tk-sigs-mode" class="form-select fw-bold">
                                <option value="sign" selected>Sign Data</option>
                                <option value="verify">Verify Sig</option>
                            </select>
                        </div>
                    </div>

                    <div id="tk-sigs-sign-block">
                        <div class="row g-3 mb-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label small">Algorithm</label>
                                <select id="tk-sigs-algo" class="form-select"></select>
                            </div>

                            <div class="col-md-4 d-none" id="tk-sigs-schnorr-wrap">
                                <label class="form-label small">Schnorr Mode</label>
                                <select id="tk-sigs-schnorr-mode" class="form-select">
                                    <option value="RFC" selected>Default (RFC)</option>
                                    <option value="BIP340">BIP340</option>
                                    <option value="TAPROOT">Taproot</option>
                                </select>
                            </div>

                            <div class="col-md-4">
                                <label class="form-check m-0">
                                    <input id="tk-sigs-hash-sign" type="checkbox" class="form-check-input">
                                    <span class="form-check-label">Hash input before signing</span>
                                </label>
                            </div>
                        </div>

                        <div class="mb-3 d-none" id="tk-sigs-merkle-wrap">
                            <label class="form-label small">Merkle Root (Base64)</label>
                            <input id="tk-sigs-merkleRoot64" class="form-control font-monospace" placeholder="Optional">
                        </div>

                        <div class="mb-3">
                            <label class="form-label small">Operation ID</label>
                            <input id="tk-sigs-op-id" class="form-control" placeholder="e.g. tx-001">
                        </div>

                        <div class="mb-3">
                            <label class="form-label d-flex align-items-center justify-content-between">
                                <span class="small">Payload</span>
                                <select id="tk-sigs-data-mode-sign" class="form-select form-select-sm w-auto">
                                    <option value="base64" selected>Base64</option>
                                    <option value="text">Text</option>
                                </select>
                            </label>
                            <textarea id="tk-sigs-data64-sign" class="form-control font-monospace bg-light" rows="3" placeholder="Payload data"></textarea>
                        </div>

                        <div class="mb-2 text-secondary small fw-bold" id="tk-sigs-status"></div>

                        <div class="mb-0">
                            <label class="form-label small text-muted text-uppercase">Result</label>
                            <textarea id="tk-sigs-result" class="form-control font-monospace bg-white border" rows="3" readonly></textarea>
                        </div>
                    </div>

                    <div class="d-none" id="tk-sigs-verify-block">
                        <div class="row g-3 mb-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label small">Signature Type</label>
                                <select id="tk-sigs-verify-type" class="form-select">
                                    <option value="SCHNORR">SCHNORR</option>
                                    <option value="ECDSA">ECDSA</option>
                                    <option value="SEC1R65SCHNORR">SEC1R65SCHNORR</option>
                                </select>
                            </div>

                            <div class="col-md-4 d-none" id="tk-sigs-verify-schnorr-wrap">
                                <label class="form-label small">Schnorr Mode</label>
                                <select id="tk-sigs-verify-schnorr-mode" class="form-select">
                                    <option value="BIP340" selected>BIP340</option>
                                    <option value="TAPROOT">Taproot</option>
                                </select>
                            </div>

                            <div class="col-md-4">
                                <label class="form-check m-0">
                                    <input id="tk-sigs-hash-verify" type="checkbox" class="form-check-input">
                                    <span class="form-check-label">Hash input before verify</span>
                                </label>
                            </div>
                        </div>

                        <div class="mb-3 d-none" id="tk-sigs-verify-merkle-wrap">
                            <label class="form-label small">Merkle Root (Base64)</label>
                            <input id="tk-sigs-verify-merkleRoot64" class="form-control font-monospace" placeholder="Optional">
                        </div>

                        <div class="mb-3">
                            <label class="form-label d-flex align-items-center justify-content-between">
                                <span class="small">Data</span>
                                <select id="tk-sigs-data-mode-verify" class="form-select form-select-sm w-auto">
                                    <option value="base64" selected>Base64</option>
                                    <option value="text">Text</option>
                                </select>
                            </label>
                            <textarea id="tk-sigs-data64-verify" class="form-control font-monospace bg-light" rows="2" placeholder="Original data"></textarea>
                        </div>

                        <div class="mb-3">
                            <label class="form-label small">Signature (Base64)</label>
                            <textarea id="tk-sigs-signature64" class="form-control font-monospace bg-light" rows="2" placeholder="Signature"></textarea>
                        </div>

                        <div class="mb-3">
                            <label class="form-label small">Generation</label>
                            <input id="tk-sigs-generation" class="form-control" placeholder="Optional (defaults to active)">
                        </div>

                        <div class="mb-2 text-secondary small fw-bold" id="tk-sigs-verify-status"></div>
                    </div>
                </div>

                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-link link-secondary" id="tk-sigs-cancel">Cancel</button>
                    <button type="button" class="btn btn-primary px-4" id="tk-sigs-submit">Run</button>
                </div>
            </div>
        </div>
    </div>

    <div class="tk-modal" id="tk-modal-crypto" tabindex="-1" aria-hidden="true">
        <div class="tk-modal-backdrop" id="tk-modal-crypto-backdrop"></div>
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content shadow-lg">
                <div class="modal-header border-bottom">
                    <h5 class="modal-title fw-bold">Cipher</h5>
                    <button type="button" class="btn-close" id="tk-crypto-close" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4 bg-body">
                    <div class="row g-2 mb-3">
                        <div class="col-md-6">
                            <label class="form-label small text-muted text-uppercase fw-bold ls-1">Key</label>
                            <input id="tk-crypto-key" class="form-control bg-light border-0 fw-mono" readonly>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small text-muted text-uppercase fw-bold ls-1">Curve</label>
                            <input id="tk-crypto-curve" class="form-control bg-light border-0 fw-mono" readonly>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small">Operation</label>
                        <select id="tk-crypto-op" class="form-select fw-bold">
                            <option value="encrypt">Encrypt</option>
                            <option value="decrypt">Decrypt</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label d-flex align-items-center justify-content-between">
                            <span id="tk-crypto-input-label" class="small">Plaintext</span>
                            <select id="tk-crypto-input-mode" class="form-select form-select-sm w-auto">
                                <option value="base64" selected>Base64</option>
                                <option value="text">Text</option>
                            </select>
                        </label>
                        <textarea id="tk-crypto-input64" class="form-control font-monospace bg-light" rows="4" placeholder="Input data"></textarea>
                    </div>

                    <div class="mb-2 text-secondary small fw-bold" id="tk-crypto-status"></div>

                    <div class="mb-0">
                        <label class="form-label d-flex align-items-center justify-content-between">
                            <span id="tk-crypto-output-label" class="small">Ciphertext</span>
                            <select id="tk-crypto-output-mode" class="form-select form-select-sm w-auto">
                                <option value="base64" selected>Base64</option>
                                <option value="text">Text</option>
                            </select>
                        </label>
                        <textarea id="tk-crypto-output64" class="form-control font-monospace bg-white border" rows="4" readonly></textarea>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-link link-secondary" id="tk-crypto-cancel">Cancel</button>
                    <button type="button" class="btn btn-primary px-4" id="tk-crypto-submit">Run</button>
                </div>
            </div>
        </div>
    </div>

    <div class="tk-modal" id="tk-modal-public" tabindex="-1" aria-hidden="true">
        <div class="tk-modal-backdrop" id="tk-modal-public-backdrop"></div>
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content shadow-lg">
                <div class="modal-header border-bottom">
                    <h5 class="modal-title fw-bold">Public Key</h5>
                    <button type="button" class="btn-close" id="tk-public-close" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4 bg-body text-center">
                    <div class="mb-3">
                        <label class="form-label small text-muted text-uppercase fw-bold ls-1">Logical ID</label>
                        <input id="tk-public-key" class="form-control border-0 text-center fw-bold bg-transparent" readonly>
                    </div>

                    <label class="form-label small text-muted text-uppercase ls-1">Public Key Material (Base64)</label>
                    <textarea id="tk-public-data64" class="form-control font-monospace bg-light text-center border-0" rows="5" readonly></textarea>
                    <div class="mt-2 text-secondary small" id="tk-public-status"></div>
                </div>
                <div class="modal-footer bg-light justify-content-center">
                    <button type="button" class="btn btn-primary w-100" id="tk-public-close2">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="tk-modal" id="tk-modal-destroy" tabindex="-1" aria-hidden="true">
        <div class="tk-modal-backdrop" id="tk-modal-destroy-backdrop"></div>
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content shadow-lg border-danger">
                <div class="modal-header bg-danger-lt border-bottom-0">
                    <h5 class="modal-title text-danger d-flex align-items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>
                        Destroy Key
                    </h5>
                    <button type="button" class="btn-close" id="tk-destroy-close" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4 bg-body">
                    <p class="text-danger mb-4 small fw-bold">
                        This action is irreversible. The key material will be permanently erased.
                    </p>
                    <div class="mb-3">
                        <label class="form-label small text-muted">Target Key</label>
                        <input id="tk-destroy-key" class="form-control bg-light border-0 fw-bold" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label small text-muted">Generation</label>
                        <input id="tk-destroy-generation" class="form-control bg-light border-0" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label small">Type the key ID to confirm</label>
                        <input id="tk-destroy-confirm" class="form-control border-danger" placeholder="Enter logical ID here...">
                    </div>
                    <div class="mb-2 text-danger small fw-bold" id="tk-destroy-status"></div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-link link-secondary" id="tk-destroy-cancel">Cancel</button>
                    <button type="button" class="btn btn-danger" id="tk-destroy-submit">Confirm Destroy</button>
                </div>
            </div>
        </div>
    </div>
</div>
